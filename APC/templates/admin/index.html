<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APC - Admin Panel</title>

    <link rel="shortcut icon" href="{{ url_for('static', filename='images/logo.png') }} ">
    <link rel="stylesheet" href="{{ url_for('static', filename='plugins/bootstrap-4.5.3-dist/css/bootstrap.min.css') }}">

    <script src="{{ url_for('static', filename='js/jquery-1.11.3.min.js') }}"></script>
</head>
<body>
    <div class="wrapper">

        <header class="navbar navbar-fixed-top logo-env">
			<nav class="navbar navbar-light bg-light" style='width: 100%'>
                <a class="navbar-brand" href="#">
                  <img src="{{ url_for('static', filename='images/logo.png') }}" width="30" height="30" class="d-inline-block align-top" alt="" loading="lazy">
                  EKITI CHAPTER
                </a>
                <span class="navbar-text">
                    <a href="#" >
                        <img src="/static/profile_pics/default_profile.jpg" alt="" class="img-circle" width="30" height="30"/>
                        <span font-size: 15px">  {{ current_user.firstname }}</span>
                    </a>
                </span>
              </nav>
        </header>
        <main>
            <div class="container">
                <div class="col-md-12">
                    {% with messages = get_flashed_messages(with_categories=true) %}
                        {% if messages %}
                        {% for category, message in messages %}
                            <div class="alert alert-dismissable alert-{{ category }}">
                                <a href="#" data-dismiss='alert' class="close">x</a>
                                {{ message }}
                            </div>
                        {% endfor %}
                        {% endif %}
                    {% endwith %}
                </div>
                <table class="table" id="user-table">
                    <thead>
                        <tr class="replace-inputs"">

                            <!-- Select button -->
                            <th style="color: black; text-align: center; vertical-align: middle;" onclick="selectVisible()">Select</th>

                            <!-- Status (online/offline) -->
                            <th style="color: black;"><input type="text" class="form-control" placeholder="First Name" /></th>

                            <!-- ID -->
                            <th style="color: black;"><input type="text" class="form-control" placeholder="Lastname" /></th>

                            <!-- IP Address -->
                            <th style="color: black;"><input type="text" class="form-control" placeholder="Phone Number" /></th>

                            <th style="color: black; text-align: center; vertical-align: middle;">Preview</th>
                            
                            <th style="color: black; text-align: center; vertical-align: middle;">Remove</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for user in users %}
                        <tr style="background-color: white; color: grey; font-size: 14px" id="user-row-{{ user.id }}">

                            <!-- Check box -->
                            <td style="text-align: center; vertical-align: middle;">
                                <div class="checkbox checkbox-replace color-blue">
                                    <input type="checkbox" id="chk-{{ user.id }}">
                                </div>
                            </td>

                            
                            <td style="text-align: center; vertical-align: middle;">
                                <span id="{{ user.id }}" style="color: gray;">{{ user.firstname }}</span>
                            </td>

                            <td style="text-align: center; vertical-align: middle;">
                                <span id="{{ user.id }}" style="color: gray;">{{ user.lastname }}</span>
                            </td>

                            <td style="text-align: center; vertical-align: middle;">
                                <span id="{{ user.id }}" style="color: gray;">{{ user.phone }}</span>
                            </td>

                            <td class="text-center">
                                <button class="btn btn-primary" name="{{ user.id }}" onclick="previewUser(this)"><i class="entypo-trash terminal-icon"></i> Preview</button>
                            </td>

                            <td class="text-center">
                                <button class="btn btn-secondary" name="{{ user.id }}" onclick="removeUser(this)"><i class="entypo-trash terminal-icon"></i>Delete</button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </main>


    </div>

    <script type='text/javascript'>
        jQuery(document).ready(function( $ ){
            var $table = jQuery('#user-table');
        })
    </script>
    <script>
        function removeUser(element){
            var res = confirm('Are you sure you want to delete this user?')
            if (res == true){
                $.post('{{ url_for("main.user_remove") }}', {user_uid: element.getAttribute('name')},
                    function(response){
                        $('#user-row-' + element.getAttribute('name')).remove();
                    }
                )
            }
        }
    </script>
    

    <script src="{{ url_for('static', filename='plugins/bootstrap-4.5.3-dist/js/bootstrap.min.js') }}" ></script>
    
</body>
</html>